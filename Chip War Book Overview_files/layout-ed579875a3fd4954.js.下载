(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{347:()=>{},1495:(e,t,r)=>{"use strict";r.d(t,{EmojiProvider:()=>I,k:()=>P});var n=r(5155),a=r(2115),o=r(8175),i=r(2374);class s{addOperation(e,t,r,n){let a="".concat(e.project_id,"-").concat(t,"-").concat(Date.now());this.queue=this.queue.filter(r=>!(r.project_id===e.project_id&&r.interaction_type===t&&!this.isOperationInProgress(r.id)));let o=e.interaction||{count:[],status:[]};if(o=this.calculateUpdatedInteraction(e,t,r),(this.callbacks.get(e.project_id)||new Set).forEach(t=>{t(e.project_id,o)}),!n)return a;let i={id:a,project_id:e.project_id,interaction_type:t,action:r,timestamp:Date.now()};return this.queue.push(i),this.scheduleBatch(),a}registerCallback(e,t){var r;return this.callbacks.has(e)||this.callbacks.set(e,new Set),null===(r=this.callbacks.get(e))||void 0===r||r.add(t),()=>{let r=this.callbacks.get(e);r&&(r.delete(t),0===r.size&&this.callbacks.delete(e))}}isOperationInProgress(e){return this.processingOperations.has(e)}getOperationKey(e){return"".concat(e.project_id,"-").concat(e.interaction_type)}scheduleBatch(){this.batchTimer&&clearTimeout(this.batchTimer),this.batchTimer=setTimeout(()=>{this.processQueue()},this.batchDelay)}async processQueue(){if(0===this.queue.length)return;this.batchTimer=null;let e=new Map;for(let r of this.queue){var t;let n=this.getOperationKey(r);e.has(n)||e.set(n,[]),null===(t=e.get(n))||void 0===t||t.push(r)}let r=[];for(let[t,n]of e.entries()){if(this.processingOperations.has(t))continue;let e=n[0];r.push(this.processOperation(e,t))}r.length>0&&(await Promise.all(r),this.queue.length>0&&this.scheduleBatch())}async processOperation(e,t){this.processingOperations.add(t),this.processingOperations.add(e.id);try{await (0,i.tw)(e.project_id,e.action,e.interaction_type),this.queue=this.queue.filter(t=>t.id!==e.id)}catch(t){console.error("Failed to process interaction operation:",t),this.queue=this.queue.filter(t=>t.id!==e.id)}finally{this.processingOperations.delete(t),this.processingOperations.delete(e.id)}}calculateUpdatedInteraction(e,t,r){var n,a;let o=[...(null===(n=e.interaction)||void 0===n?void 0:n.count)||[]],s=[...(null===(a=e.interaction)||void 0===a?void 0:a.status)||[]],l=s.findIndex(e=>e.interaction_type===t);l>=0?s[l]={...s[l],status:r===i.f3.Add}:r===i.f3.Add&&s.push({interaction_type:t,status:!0});let c=o.findIndex(e=>e.interaction_type===t);if(c>=0){let e=r===i.f3.Add?1:-1;o[c]={...o[c],count:Math.max(0,o[c].count+e)}}else r===i.f3.Add&&o.push({interaction_type:t,count:1});return{count:o,status:s}}constructor(){this.queue=[],this.processingOperations=new Set,this.batchTimer=null,this.batchDelay=500,this.callbacks=new Map}}let l="yourware-emoji-list",c="yourware-emoji-lottie-cache",u=[],d=!1,f=[],h={},p=new Map,g=!1,m=e=>{f.forEach(t=>t(e)),f=[]},y=()=>{try{let e=localStorage.getItem(c);e&&(h=JSON.parse(atob(e)))}catch(e){console.error("Failed to load Lottie cache",e),h={},localStorage.removeItem(c)}},b=()=>{try{localStorage.setItem(c,btoa(JSON.stringify(h)))}catch(e){console.error("Failed to save Lottie cache",e)}},w=async e=>{if(!e||h[e]&&h[e].expireTime>Date.now()&&h[e].data)return;if(p.has(e))return p.get(e);let t=(async()=>{try{console.log("Start loading Lottie: ".concat(e));let t=await fetch(e),r=await t.json();h[e]={data:r,expireTime:Date.now()+864e5},b(),console.log("Lottie loaded successfully: ".concat(e))}catch(t){console.error("Failed to preload Lottie: ".concat(e),t)}finally{p.delete(e)}})();return p.set(e,t),t},v=e=>{g||(g=!0,y(),setTimeout(async()=>{try{console.log("Start preloading all Lottie animations");let t=e.filter(e=>e.lottie).map(e=>e.lottie);await Promise.all([...new Set(t)].map(e=>w(e))),console.log("All Lottie animations preloaded successfully")}catch(e){console.error("Failed to preload Lottie animations",e)}finally{g=!1}},2e3))},_=e=>e?h[e]&&h[e].expireTime>Date.now()&&h[e].data?h[e].data:(p.has(e)||setTimeout(()=>{w(e).catch(console.error)},0),null):null,x=()=>{try{let e=localStorage.getItem(l);if(!e)return{data:[],isExpired:!0};let t=JSON.parse(atob(e)),r=t.expireTime<Date.now();return{data:t.data,isExpired:r}}catch(e){return console.error("Failed to read emoji cache",e),localStorage.removeItem(l),{data:[],isExpired:!0}}},j=e=>{try{let t={data:e,expireTime:Date.now()+3e5};localStorage.setItem(l,btoa(JSON.stringify(t)))}catch(e){console.error("Failed to save emoji cache",e)}},O=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(d)return new Promise(e=>{f.push(e)});if(u.length>0&&!e)return u;if(!e){let{data:e,isExpired:t}=x();if(e.length>0)return u=e,t?setTimeout(()=>{O(!0).catch(console.error)},0):g||v(e),u}try{d=!0;let e=(await (0,i.hl)()).data||[];return u=e,j(e),g||v(e),m(e),e}catch(e){return console.error("Failed to fetch emojis",e),m(u),u}finally{d=!1}},S=(0,a.createContext)({emojis:[],isLoading:!1,getEmojiByType:()=>void 0,refreshEmojis:async()=>{},asyncGetEmojis:async()=>[],getLottieData:()=>null,interact:()=>Promise.resolve(""),registerInteractionCallback:()=>{}}),I=e=>{let{children:t}=e,[r,i]=(0,a.useState)([]),[l,c]=(0,a.useState)(!1),{user:d}=(0,o.A)(),f=(0,a.useRef)(new s);(0,a.useEffect)(()=>{y()},[]),(0,a.useEffect)(()=>{let e=!0;return(async()=>{c(!0);let t=await h();e&&(i(t),c(!1))})(),()=>{e=!1}},[]);let h=async()=>{if(u.length>0){let{isExpired:e}=x();return e&&!l&&setTimeout(()=>{O(!0).catch(console.error)},0),u}return O()},p=async(e,t,r)=>f.current.addOperation(e,t,r,(null==d?void 0:d.uid)||""),g=async()=>{await O(!0)};return(0,n.jsx)(S.Provider,{value:{emojis:r,isLoading:l,getEmojiByType:e=>r.find(t=>t.interaction_type===e),refreshEmojis:g,asyncGetEmojis:h,getLottieData:_,interact:p,registerInteractionCallback:(e,t)=>{f.current.registerCallback(e,t)}},children:t})},P=()=>(0,a.useContext)(S)},2002:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,9243,23)),Promise.resolve().then(r.t.bind(r,6867,23)),Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,8554)),Promise.resolve().then(r.bind(r,7389)),Promise.resolve().then(r.bind(r,8175)),Promise.resolve().then(r.bind(r,1495)),Promise.resolve().then(r.bind(r,9891))},2374:(e,t,r)=>{"use strict";r.d(t,{f3:()=>o,hl:()=>s,tw:()=>i});var n=r(466);let a={interact:"/v1/community/interact",emoji_list:"/v1/community/emoji/list"};var o=function(e){return e.Add="add",e.Cancel="cancel",e}({});async function i(e,t,r){return await (0,n.qM)(a.interact,{method:"POST",data:{project_id:e,action:t,interaction_type:r}})}async function s(){return await (0,n.qM)(a.emoji_list,{method:"GET"})}},2714:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"setAttributesFromProps",{enumerable:!0,get:function(){return o}});let r={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",noModule:"noModule"},n=["onLoad","onReady","dangerouslySetInnerHTML","children","onError","strategy","stylesheets"];function a(e){return["async","defer","noModule"].includes(e)}function o(e,t){for(let[o,i]of Object.entries(t)){if(!t.hasOwnProperty(o)||n.includes(o)||void 0===i)continue;let s=r[o]||o.toLowerCase();"SCRIPT"===e.tagName&&a(s)?e[s]=!!i:e.setAttribute(s,String(i)),(!1===i||"SCRIPT"===e.tagName&&a(s)&&(!i||"false"===i))&&(e.setAttribute(s,""),e.removeAttribute(s))}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4744:(e,t,r)=>{"use strict";r.d(t,{A$:()=>o,e6:()=>a,xx:()=>i});var n=r(466);async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"published",r=arguments.length>2?arguments[2]:void 0,a={};return e.cursor&&(a.cursor=e.cursor),e.page_size&&(a.page_size=e.page_size),await (0,n.qM)("/v1/users/".concat(e.uid,"/").concat("published"===t?"projects":"drafts"),{method:"GET",params:a,extra_headers:r})}async function o(e){return await (0,n.qM)("/v1/users/".concat(e.uid,"/link_projects"),{method:"POST",data:{project_ids:e.project_ids}})}async function i(e,t){return await (0,n.qM)("/v1/projects/delete",{method:"POST",data:{project_ids:e,uid:t}})}},4821:(e,t,r)=>{"use strict";r.d(t,{B:()=>o,S:()=>a});let n=()=>{},a=e=>{n(e)},o=e=>n=e},6867:e=>{e.exports={style:{fontFamily:"'Courier Prime', 'Courier Prime Fallback'",fontStyle:"normal"},className:"__className_4c6a12",variable:"__variable_4c6a12"}},7389:(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var n=r(5155),a=r(5427),o=r(2115),i=r(8436);let s=e=>{switch(e){case"success":return(0,n.jsx)(a.Jnp,{className:"h-4 w-4 text-[#14AE5C]"});case"error":return(0,n.jsx)(a.sFm,{className:"h-4 w-4 text-[#ef4444]"});case"info":return(0,n.jsx)(a.CwO,{className:"h-4 w-4 text-black/95"});case"warning":return(0,n.jsx)(a._8L,{className:"h-4 w-4 text-[#f59e0b]"});default:return null}};function l(){let[e,t]=(0,o.useState)(null);if((0,o.useEffect)(()=>((0,i.B)(t),()=>{(0,i.B)(()=>{})}),[]),!e)return null;let{message:r,type:a="info",icon:l}=e;return(0,n.jsxs)("div",{className:"fixed top-8 left-1/2 z-50 flex -translate-x-1/2 transform items-center gap-2 rounded-xl bg-white px-4 py-3 text-sm font-normal text-black shadow-lg transition-opacity duration-300",style:{transition:"opacity 300ms ease-in-out"},children:[l||s(a),(0,n.jsx)("span",{className:"leading-5 text-black",children:r})]})}},8175:(e,t,r)=>{"use strict";let n,a;r.d(t,{AuthProvider:()=>w,A:()=>v});var o=r(5155),i=r(5695),s=r(2115),l=r(3915),c=r(6203);let u=JSON.parse('{"apiKey":"AIzaSyB9Jdqpb4h5RgHmRRJSfqTOfBT-DPV34jA","authDomain":"gglogin.yourware.so","projectId":"yourware-arco","storageBucket":"yourware-arco.firebasestorage.app","messagingSenderId":"541265544701","appId":"1:541265544701:web:d52622395895582c9c4594"}');function d(){if(!a){let{auth:e}=u?(n=(0,l.Dk)().length?(0,l.Dk)()[0]:(0,l.Wp)(u),a=(0,c.xI)(n),(0,c.oM)(a,c.gz),{app:n,auth:a}):(console.error("firebaseConfig is undefined"),{app:void 0,auth:void 0});a=e}return a}async function f(e){let t=e.user,r=t.providerData.find(e=>"google.com"===e.providerId);if(r){let{displayName:e,photoURL:n}=r;if(!t.displayName&&e&&await (0,c.r7)(t,{displayName:e}),!t.photoURL&&n){let e=n.replace(/=s\d+-c$/,"=s400-c");await (0,c.r7)(t,{photoURL:e})}}let n=await t.getIdToken(),a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:n})}),o=await a.json();return console.log("postGoogleAuth response",o),o}async function h(){let e=d();if(!e)throw console.error("auth is undefined"),Error("auth is undefined");let t=new c.HF;try{var r;let n=await (0,c.df)(e,t);await e.signOut();let a=await f(n);if(!(null===(r=a.data)||void 0===r?void 0:r.userInfo))throw Error("Failed to login");return a.data.userInfo}catch(e){throw console.error("sign in with google error:",e),e}}async function p(){let e=d();if(!e)throw console.error("auth is undefined"),Error("auth is undefined");try{return await e.signOut(),console.log("sign out successfully"),await fetch("/api/auth/logout",{method:"POST"})}catch(e){throw console.error("sign out error:",e),e}}var g=r(4744),m=r(6389),y=r(466);let b=(0,s.createContext)({user:null,isLoading:!1,loginWithGoogle:async()=>{},logout:async()=>{},updateProfile:async(e,t)=>Promise.resolve({code:0,message:"Success",request_id:"",data:null})}),w=e=>{let{currentUser:t,children:r}=e,[n,a]=(0,s.useState)(t),[l,c]=(0,s.useState)(!1);(0,i.useRouter)();let{identify:u}=(0,m.s)();(0,s.useEffect)(()=>{a(t)},[t]),(0,s.useEffect)(()=>{u(n)},[n]);let d=async()=>{try{c(!0);let e=await h();if(console.log("sign in with google success"),a(e),null==e?void 0:e.uid){let t=JSON.parse(localStorage.getItem("Anonymous_Projects")||"[]");t.length>0&&(0,g.A$)({uid:e.uid,project_ids:t}).then(()=>{console.log("Projects linked successfully in background"),localStorage.removeItem("Anonymous_Projects")}).catch(e=>console.error("Background project linking failed:",e))}}catch(e){throw console.error("sign in with google error:",e),e}finally{c(!1)}},f=async()=>{try{console.log("sign out"),await p(),a(null)}catch(e){throw console.error("sign out error:",e),e}},w=async(e,t)=>{try{let r=new FormData;return e&&r.append("name",e),t&&r.append("photo",t),await (0,y.qM)("/user/refresh",{method:"POST",body:r})}catch(e){throw console.error("update profile error:",e),e}};return(0,o.jsx)(b.Provider,{value:{user:n,isLoading:l,loginWithGoogle:d,logout:f,updateProfile:w},children:r})},v=()=>(0,s.useContext)(b)},8554:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var n=r(5155),a=r(2115),o=r(4821);function i(){let[e,t]=(0,a.useState)(null);if((0,a.useEffect)(()=>((0,o.B)(t),()=>{(0,o.B)(()=>{})}),[]),!e)return null;let{title:r,description:i,cancelText:s="Cancel",confirmText:l="Confirm",onCancel:c,onConfirm:u,cancelClassName:d="",confirmClassName:f=""}=e,h=()=>{c&&c(),t(null)};return(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 p-4",onClick:e=>{e.target===e.currentTarget&&h()},children:(0,n.jsxs)("div",{className:"flex w-full max-w-128 flex-col gap-2 rounded-[20px] bg-white p-6 shadow-[0px_0px_2px_0px_rgba(0,0,0,0.10),0px_16px_32px_-1px_rgba(0,0,0,0.05)]",children:[(0,n.jsx)("h3",{className:"text-xl font-bold",children:r}),i&&(0,n.jsx)("div",{className:"mb-6 text-base font-normal tracking-tight text-black/65",children:i}),(0,n.jsxs)("div",{className:"flex justify-end gap-3",children:[c&&(0,n.jsx)("button",{className:"flex h-9 cursor-pointer items-center justify-center rounded-[10px] border border-gray-300 px-4 font-medium transition-colors hover:bg-gray-100 ".concat(d),onClick:h,children:s}),u&&(0,n.jsx)("button",{className:"bg-brand hover:bg-brand/85 flex h-9 cursor-pointer items-center justify-center rounded-[10px] px-5 text-white transition-colors ".concat(f),onClick:()=>{u&&u(),t(null)},children:l})]})]})})}},9243:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return b},handleClientScriptLoad:function(){return g},initScriptLoader:function(){return m}});let n=r(8229),a=r(6966),o=r(5155),i=n._(r(7650)),s=a._(r(2115)),l=r(2830),c=r(2714),u=r(9993),d=new Map,f=new Set,h=e=>{if(i.default.preinit){e.forEach(e=>{i.default.preinit(e,{as:"style"})});return}{let t=document.head;e.forEach(e=>{let r=document.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e,t.appendChild(r)})}},p=e=>{let{src:t,id:r,onLoad:n=()=>{},onReady:a=null,dangerouslySetInnerHTML:o,children:i="",strategy:s="afterInteractive",onError:l,stylesheets:u}=e,p=r||t;if(p&&f.has(p))return;if(d.has(t)){f.add(p),d.get(t).then(n,l);return}let g=()=>{a&&a(),f.add(p)},m=document.createElement("script"),y=new Promise((e,t)=>{m.addEventListener("load",function(t){e(),n&&n.call(this,t),g()}),m.addEventListener("error",function(e){t(e)})}).catch(function(e){l&&l(e)});o?(m.innerHTML=o.__html||"",g()):i?(m.textContent="string"==typeof i?i:Array.isArray(i)?i.join(""):"",g()):t&&(m.src=t,d.set(t,y)),(0,c.setAttributesFromProps)(m,e),"worker"===s&&m.setAttribute("type","text/partytown"),m.setAttribute("data-nscript",s),u&&h(u),document.body.appendChild(m)};function g(e){let{strategy:t="afterInteractive"}=e;"lazyOnload"===t?window.addEventListener("load",()=>{(0,u.requestIdleCallback)(()=>p(e))}):p(e)}function m(e){e.forEach(g),[...document.querySelectorAll('[data-nscript="beforeInteractive"]'),...document.querySelectorAll('[data-nscript="beforePageRender"]')].forEach(e=>{let t=e.id||e.getAttribute("src");f.add(t)})}function y(e){let{id:t,src:r="",onLoad:n=()=>{},onReady:a=null,strategy:c="afterInteractive",onError:d,stylesheets:h,...g}=e,{updateScripts:m,scripts:y,getIsSsr:b,appDir:w,nonce:v}=(0,s.useContext)(l.HeadManagerContext),_=(0,s.useRef)(!1);(0,s.useEffect)(()=>{let e=t||r;_.current||(a&&e&&f.has(e)&&a(),_.current=!0)},[a,t,r]);let x=(0,s.useRef)(!1);if((0,s.useEffect)(()=>{if(!x.current){if("afterInteractive"===c)p(e);else if("lazyOnload"===c)"complete"===document.readyState?(0,u.requestIdleCallback)(()=>p(e)):window.addEventListener("load",()=>{(0,u.requestIdleCallback)(()=>p(e))});x.current=!0}},[e,c]),("beforeInteractive"===c||"worker"===c)&&(m?(y[c]=(y[c]||[]).concat([{id:t,src:r,onLoad:n,onReady:a,onError:d,...g}]),m(y)):b&&b()?f.add(t||r):b&&!b()&&p(e)),w){if(h&&h.forEach(e=>{i.default.preinit(e,{as:"style"})}),"beforeInteractive"===c)return r?(i.default.preload(r,g.integrity?{as:"script",integrity:g.integrity,nonce:v,crossOrigin:g.crossOrigin}:{as:"script",nonce:v,crossOrigin:g.crossOrigin}),(0,o.jsx)("script",{nonce:v,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([r,{...g,id:t}])+")"}})):(g.dangerouslySetInnerHTML&&(g.children=g.dangerouslySetInnerHTML.__html,delete g.dangerouslySetInnerHTML),(0,o.jsx)("script",{nonce:v,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([0,{...g,id:t}])+")"}}));"afterInteractive"===c&&r&&i.default.preload(r,g.integrity?{as:"script",integrity:g.integrity,nonce:v,crossOrigin:g.crossOrigin}:{as:"script",nonce:v,crossOrigin:g.crossOrigin})}return null}Object.defineProperty(y,"__nextScript",{value:!0});let b=y;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9993:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{cancelIdleCallback:function(){return n},requestIdleCallback:function(){return r}});let r="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(e){let t=Date.now();return self.setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},n="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(e){return clearTimeout(e)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}},e=>{var t=t=>e(e.s=t);e.O(0,[1543,8229,8823,8888,3464,9851,8935,8441,1684,7358],()=>t(2002)),_N_E=e.O()}]);